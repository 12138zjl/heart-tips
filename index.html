<!doctype html>
<html lang="zh-CN">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>tk.py → 浏览器演示（心形提示）</title>
  <style>
    :root{--tip-w:220px;--tip-h:56px}
    html,body{height:100%;margin:0;font-family: "微软雅黑", system-ui, -apple-system, "Segoe UI", Roboto, Arial}
    body{background:linear-gradient(180deg,#fff 0%,#ffeef6 100%);overflow:hidden}
    .tip{position:absolute; width:var(--tip-w); height:var(--tip-h); display:flex; align-items:center; justify-content:center; color:white; border-radius:10px; box-shadow:0 6px 18px rgba(0,0,0,0.18); padding:8px; box-sizing:border-box; text-align:center; font-weight:700; font-size:14px; transform:translate(-50%,-50%); transition: left 900ms cubic-bezier(.2,.8,.2,1), top 900ms cubic-bezier(.2,.8,.2,1), background-color 300ms }
    .controls{position:fixed; left:12px; top:12px; z-index:9999}
    button{padding:8px 12px; margin-right:8px; border-radius:6px; border:0; background:#ff6fa3; color:#fff; cursor:pointer}
    .note{position:fixed; right:12px; top:12px; background:#fff; padding:8px 12px; border-radius:6px; box-shadow:0 6px 18px rgba(0,0,0,0.08)}
  </style>
</head>
<body>
  <div class="controls">
    <button id="startBtn">开始演示</button>
    <button id="resetBtn">重置</button>
  </div>
  
  <script>
    // 参数（可调整）
    const NUM_WINDOWS = 110;
    const SPAWN_INTERVAL_MS = 80;
    const LAST_EXTRA_MS = 2000; // 最后一窗额外停留时间
    const TIP_W = 220, TIP_H = 56;

    // 生成心形点（屏幕坐标）
    function generateHeartPoints(count, w, h, scale=18){
      const pts = [];
      for(let i=0;i<count;i++){
        const t = (i / count) * Math.PI * 2;
        // 使用经典心形参数化方程（适合浏览器）
        const x = 16 * Math.pow(Math.sin(t), 3);
        const y = - (13 * Math.cos(t) - 5 * Math.cos(2*t) - 2 * Math.cos(3*t) - Math.cos(4*t));
        const cx = w/2, cy = h/2;
        const px = Math.round(cx + x * scale);
        const py = Math.round(cy + y * scale);
        pts.push([px, py]);
      }
      return pts;
    }

    // 随机颜色数组
    const BG_COLORS = ['#ffb6c1','#ff8fa8','#ff66a3','#f784c2','#ffb3c6','#ffcce2','#ff9bb2'];
    const love_texts = [
      '遇见你，是我一生的幸运','你是我生命中最美好的意外','想把世界上最好的都给你',
      '我的心很小，只装得下你','余生，请多指教','我喜欢你，从一而终','你是我最重要的决定',
      '有你的每一天都是情人节','你的笑容是我最大的幸福','我爱你，不只是说说而已','你是我永恒的心动','我永远爱你'
    ];

    let createdTips = [];
    let spawnTimer = null;

    function clamp(n, a, b){ return Math.max(a, Math.min(b, n)); }

    function createTip(text, x, y){
      const el = document.createElement('div');
      el.className = 'tip';
      el.style.left = x + 'px';
      el.style.top = y + 'px';
      el.style.width = TIP_W + 'px';
      el.style.height = TIP_H + 'px';
      el.style.background = BG_COLORS[Math.floor(Math.random()*BG_COLORS.length)];
      el.textContent = text;
      el.style.zIndex = 1000 + createdTips.length;
      document.body.appendChild(el);
      createdTips.push(el);
      return el;
    }

    function clearTips(){
      if(spawnTimer) { clearTimeout(spawnTimer); spawnTimer = null; }
      createdTips.forEach(e=>e.remove());
      createdTips = [];
    }

    function startDemo(){
      clearTips();
      const w = window.innerWidth, h = window.innerHeight;
      const pts = generateHeartPoints(NUM_WINDOWS, w, h, Math.min(w,h)/40);
      let i = 0;

      function spawnNext(){
        if(i>=pts.length){
          // 创建完成：等待最后额外时间，然后扩散
          setTimeout(()=>{ scatterTips(); }, LAST_EXTRA_MS);
          return;
        }
        const [px,py] = pts[i];
        const text = (i===pts.length-1) ? '訾家乐❤谢苗苗' : love_texts[Math.floor(Math.random()*love_texts.length)];
        createTip(text, clamp(px, TIP_W/2, w-TIP_W/2), clamp(py, TIP_H/2, h-TIP_H/2));
        i++;
        spawnTimer = setTimeout(spawnNext, SPAWN_INTERVAL_MS);
      }
      spawnNext();
    }

    function scatterTips(){
      const w = window.innerWidth, h = window.innerHeight;
      createdTips.forEach((el, idx)=>{
        // 随机位置，留出边距
        const tx = Math.floor(Math.random()*(w - TIP_W)) + TIP_W/2;
        const ty = Math.floor(Math.random()*(h - TIP_H)) + TIP_H/2;
        // 使用随机延迟让效果更生动
        const delay = Math.random()*800;
        setTimeout(()=>{
          el.style.left = tx + 'px';
          el.style.top = ty + 'px';
        }, delay);
      });
    }

    document.getElementById('startBtn').addEventListener('click', startDemo);
    document.getElementById('resetBtn').addEventListener('click', clearTips);

    // 可选：页面加载后自动开始
    // window.addEventListener('load', startDemo);
  </script>
</body>
</html>
